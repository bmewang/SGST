function StressTensor= sigmaNSGST(N, StructureTensorList, PrincipleDirection, a, b, FF)
% For a given deformation gradient "FF" sigmaNSGST returns the true Cauchy 
% stress where "PrincipleDirection" signifies which index corresponds to 
% the mean fibre direction. Thus, you have to make sure that "FF" is defined
% in the same base system. "N" denotes to which order the nSGST-model is
% evaluated, demanding an equal amount of structur tensors which have to be
% calculated beforehand using function "MN". Models available range from 
% zeroth to third order. Material parameters "a" and "b" resemble fibre 
% stiffness as within the HO-model.

if N>4
    error("sigmaNSGST only supports expansion up to order 4")
elseif N> length(StructureTensorList)
    error("The order of the Taylor-Series must not exceed the amount of Structure Tensors handed to this function")
end

if floor(PrincipleDirection)~=PrincipleDirection || PrincipleDirection>3
    error("PrincipleDirection mus take values 1,2, or 3 to determine which is the mean fibre direction")
end

switch PrincipleDirection
    case 1
        main = 1; side1 = 2; side2 = 3;
    case 2
        main = 2; side1 = 1; side2 = 3;
    case 3
        main = 3; side1 = 2; side2 = 1;
end
C = (FF'*FF-eye(3))/2; 


M2 = StructureTensorList{1};

C2M2 = C(main,main)^2*M2(1)+ M2(3)*( C(side1,side1)^2+C(side2,side2)^2)+ ...
    2*( M2(2)*(C(main,main)*( C(side1,side1)+C(side2,side2) )+2*C(main,side2)^2+2*C(main,side1)^2 )+ M2(4)*(C(side1,side1)*C(side2,side2)+2*C(side1,side2)^2));    


M2D=zeros(3,3);
M2D(main,side1) = 2*M2(2)*C(main,side1);
M2D(main,side2) = 2*M2(2)*C(main,side2);
M2D(side1,side2) = 2*M2(4)*C(side1,side2);
M2D = M2D+M2D';
M2D(main,main) = M2(1)*C(main,main) + M2(2)*(C(side1,side1) + C(side2,side2));
M2D(side1,side1) = M2(2)*C(main,main) + M2(3)*C(side1,side1) + M2(4)*C(side2,side2);
M2D(side2,side2) = M2(2)*C(main,main) + M2(4)*C(side1,side1) + M2(3)*C(side2,side2);

Prefactor = 4*a*exp(4*b*C2M2);

Accumulant = M2D;

if N>=2
    M4 = StructureTensorList{2};

    C4M4 = C(main,main).^4.*M4(1)+(24.*C(main,main).^2.*C(main,side1).^2+24.*C(main,main).^2.*C(main,side2).^2+4.*C(main,main).^3.*C(side1,side1)+4.*C(main,main).^3.*C(side2,side2)).*M4(2)+(16.*C(main,side1).^4+16.*C(main,side2).^4+48.*C(main,main).*C(main,side1).^2.*C(side1,side1)+6.*C(main,main).^2.*C(side1,side1).^2+48.*C(main,main).*C(main,side2).^2.*C(side2,side2)+6.*C(main,main).^2.*C(side2,side2).^2).*M4(3)+(96.*C(main,side1).^2.*C(main,side2).^2+48.*C(main,main).*C(main,side2).^2.*C(side1,side1)+192.*C(main,main).*C(main,side1).*C(main,side2).*C(side1,side2)+24.*C(main,main).^2.*C(side1,side2).^2+48.*C(main,main).*C(main,side1).^2.*C(side2,side2)+12.*C(main,main).^2.*C(side1,side1).*C(side2,side2)).*M4(4)+(24.*C(main,side1).^2.*C(side1,side1).^2+4.*C(main,main).*C(side1,side1).^3+24.*C(main,side2).^2.*C(side2,side2).^2+4.*C(main,main).*C(side2,side2).^3).*M4(5)+(24.*C(main,side2).^2.*C(side1,side1).^2+192.*C(main,side1).*C(main,side2).*C(side1,side1).*C(side1,side2)+96.*C(main,side1).^2.*C(side1,side2).^2+96.*C(main,side2).^2.*C(side1,side2).^2+48.*C(main,main).*C(side1,side1).*C(side1,side2).^2+48.*C(main,side1).^2.*C(side1,side1).*C(side2,side2)+48.*C(main,side2).^2.*C(side1,side1).*C(side2,side2)+12.*C(main,main).*C(side1,side1).^2.*C(side2,side2)+192.*C(main,side1).*C(main,side2).*C(side1,side2).*C(side2,side2)+48.*C(main,main).*C(side1,side2).^2.*C(side2,side2)+24.*C(main,side1).^2.*C(side2,side2).^2+12.*C(main,main).*C(side1,side1).*C(side2,side2).^2).*M4(6)+(C(side1,side1).^4+C(side2,side2).^4).*M4(7)+(24.*C(side1,side1).^2.*C(side1,side2).^2+4.*C(side1,side1).^3.*C(side2,side2)+24.*C(side1,side2).^2.*C(side2,side2).^2+4.*C(side1,side1).*C(side2,side2).^3).*M4(8)+(16.*C(side1,side2).^4+48.*C(side1,side1).*C(side1,side2).^2.*C(side2,side2)+6.*C(side1,side1).^2.*C(side2,side2).^2).*M4(9);
        
    M4D = zeros(3,3);
    M4D(main,side1)=24.*C(main,main).^2.*C(main,side1).*M4(2)+(1/2).*(64.*C(main,side1).^3+96.*C(main,main).*C(main,side1).*C(side1,side1)).*M4(3)+(1/2).*(192.*C(main,side1).*C(main,side2).^2+192.*C(main,main).*C(main,side2).*C(side1,side2)+96.*C(main,main).*C(main,side1).*C(side2,side2)).*M4(4)+24.*C(main,side1).*C(side1,side1).^2.*M4(5)+(1/2).*(192.*C(main,side2).*C(side1,side1).*C(side1,side2)+192.*C(main,side1).*C(side1,side2).^2+96.*C(main,side1).*C(side1,side1).*C(side2,side2)+192.*C(main,side2).*C(side1,side2).*C(side2,side2)+48.*C(main,side1).*C(side2,side2).^2).*M4(6);
    M4D(main,side2)=24.*C(main,main).^2.*C(main,side2).*M4(2)+(1/2).*(64.*C(main,side2).^3+96.*C(main,main).*C(main,side2).*C(side2,side2)).*M4(3)+(1/2).*(192.*C(main,side1).^2.*C(main,side2)+96.*C(main,main).*C(main,side2).*C(side1,side1)+192.*C(main,main).*C(main,side1).*C(side1,side2)).*M4(4)+24.*C(main,side2).*C(side2,side2).^2.*M4(5)+(1/2).*(48.*C(main,side2).*C(side1,side1).^2+192.*C(main,side1).*C(side1,side1).*C(side1,side2)+192.*C(main,side2).*C(side1,side2).^2+96.*C(main,side2).*C(side1,side1).*C(side2,side2)+192.*C(main,side1).*C(side1,side2).*C(side2,side2)).*M4(6);
    M4D(side1,side2)=(1/2).*(192.*C(main,main).*C(main,side1).*C(main,side2)+48.*C(main,main).^2.*C(side1,side2)).*M4(4)+(1/2).*(192.*C(main,side1).*C(main,side2).*C(side1,side1)+192.*C(main,side1).^2.*C(side1,side2)+192.*C(main,side2).^2.*C(side1,side2)+96.*C(main,main).*C(side1,side1).*C(side1,side2)+192.*C(main,side1).*C(main,side2).*C(side2,side2)+96.*C(main,main).*C(side1,side2).*C(side2,side2)).*M4(6)+(1/2).*(48.*C(side1,side1).^2.*C(side1,side2)+48.*C(side1,side2).*C(side2,side2).^2).*M4(8)+(1/2).*(64.*C(side1,side2).^3+96.*C(side1,side1).*C(side1,side2).*C(side2,side2)).*M4(9);
    M4D = M4D+M4D';
    M4D(main,main)=4.*C(main,main).^3.*M4(1)+(48.*C(main,main).*C(main,side1).^2+48.*C(main,main).*C(main,side2).^2+12.*C(main,main).^2.*C(side1,side1)+12.*C(main,main).^2.*C(side2,side2)).*M4(2)+(48.*C(main,side1).^2.*C(side1,side1)+12.*C(main,main).*C(side1,side1).^2+48.*C(main,side2).^2.*C(side2,side2)+12.*C(main,main).*C(side2,side2).^2).*M4(3)+(48.*C(main,side2).^2.*C(side1,side1)+192.*C(main,side1).*C(main,side2).*C(side1,side2)+48.*C(main,main).*C(side1,side2).^2+48.*C(main,side1).^2.*C(side2,side2)+24.*C(main,main).*C(side1,side1).*C(side2,side2)).*M4(4)+(4.*C(side1,side1).^3+4.*C(side2,side2).^3).*M4(5)+(48.*C(side1,side1).*C(side1,side2).^2+12.*C(side1,side1).^2.*C(side2,side2)+48.*C(side1,side2).^2.*C(side2,side2)+12.*C(side1,side1).*C(side2,side2).^2).*M4(6);
    M4D(side1,side1)=4.*C(main,main).^3.*M4(2)+(48.*C(main,main).*C(main,side1).^2+12.*C(main,main).^2.*C(side1,side1)).*M4(3)+(48.*C(main,main).*C(main,side2).^2+12.*C(main,main).^2.*C(side2,side2)).*M4(4)+(48.*C(main,side1).^2.*C(side1,side1)+12.*C(main,main).*C(side1,side1).^2).*M4(5)+(48.*C(main,side2).^2.*C(side1,side1)+192.*C(main,side1).*C(main,side2).*C(side1,side2)+48.*C(main,main).*C(side1,side2).^2+48.*C(main,side1).^2.*C(side2,side2)+48.*C(main,side2).^2.*C(side2,side2)+24.*C(main,main).*C(side1,side1).*C(side2,side2)+12.*C(main,main).*C(side2,side2).^2).*M4(6)+4.*C(side1,side1).^3.*M4(7)+(48.*C(side1,side1).*C(side1,side2).^2+12.*C(side1,side1).^2.*C(side2,side2)+4.*C(side2,side2).^3).*M4(8)+(48.*C(side1,side2).^2.*C(side2,side2)+12.*C(side1,side1).*C(side2,side2).^2).*M4(9);
    M4D(side2,side2)=4.*C(main,main).^3.*M4(2)+(48.*C(main,main).*C(main,side2).^2+12.*C(main,main).^2.*C(side2,side2)).*M4(3)+(48.*C(main,main).*C(main,side1).^2+12.*C(main,main).^2.*C(side1,side1)).*M4(4)+(48.*C(main,side2).^2.*C(side2,side2)+12.*C(main,main).*C(side2,side2).^2).*M4(5)+(48.*C(main,side1).^2.*C(side1,side1)+48.*C(main,side2).^2.*C(side1,side1)+12.*C(main,main).*C(side1,side1).^2+192.*C(main,side1).*C(main,side2).*C(side1,side2)+48.*C(main,main).*C(side1,side2).^2+48.*C(main,side1).^2.*C(side2,side2)+24.*C(main,main).*C(side1,side1).*C(side2,side2)).*M4(6)+4.*C(side2,side2).^3.*M4(7)+(4.*C(side1,side1).^3+48.*C(side1,side2).^2.*C(side2,side2)+12.*C(side1,side1).*C(side2,side2).^2).*M4(8)+(48.*C(side1,side1).*C(side1,side2).^2+12.*C(side1,side1).^2.*C(side2,side2)).*M4(9);
    M4D=M4D/4;
    
    Accumulant = Accumulant + 4*b*( 2*b* (C4M4-C2M2^2) *M2D + M4D-C2M2*M2D );
    if N>= 3
        M6 =StructureTensorList{3};
        C6M6 = C(main,main).^6.*M6(1)+(60.*C(main,main).^4.*C(main,side1).^2+60.*C(main,main).^4.*C(main,side2).^2+6.*C(main,main).^5.*C(side1,side1)+6.*C(main,main).^5.*C(side2,side2)).*M6(2)+(240.*C(main,main).^2.*C(main,side1).^4+240.*C(main,main).^2.*C(main,side2).^4+240.*C(main,main).^3.*C(main,side1).^2.*C(side1,side1)+15.*C(main,main).^4.*C(side1,side1).^2+240.*C(main,main).^3.*C(main,side2).^2.*C(side2,side2)+15.*C(main,main).^4.*C(side2,side2).^2).*M6(3)+(1440.*C(main,main).^2.*C(main,side1).^2.*C(main,side2).^2+240.*C(main,main).^3.*C(main,side2).^2.*C(side1,side1)+960.*C(main,main).^3.*C(main,side1).*C(main,side2).*C(side1,side2)+60.*C(main,main).^4.*C(side1,side2).^2+240.*C(main,main).^3.*C(main,side1).^2.*C(side2,side2)+30.*C(main,main).^4.*C(side1,side1).*C(side2,side2)).*M6(4)+(64.*C(main,side1).^6+64.*C(main,side2).^6+480.*C(main,main).*C(main,side1).^4.*C(side1,side1)+360.*C(main,main).^2.*C(main,side1).^2.*C(side1,side1).^2+20.*C(main,main).^3.*C(side1,side1).^3+480.*C(main,main).*C(main,side2).^4.*C(side2,side2)+360.*C(main,main).^2.*C(main,side2).^2.*C(side2,side2).^2+20.*C(main,main).^3.*C(side2,side2).^3).*M6(5)+(960.*C(main,side1).^4.*C(main,side2).^2+960.*C(main,side1).^2.*C(main,side2).^4+2880.*C(main,main).*C(main,side1).^2.*C(main,side2).^2.*C(side1,side1)+480.*C(main,main).*C(main,side2).^4.*C(side1,side1)+360.*C(main,main).^2.*C(main,side2).^2.*C(side1,side1).^2+3840.*C(main,main).*C(main,side1).^3.*C(main,side2).*C(side1,side2)+3840.*C(main,main).*C(main,side1).*C(main,side2).^3.*C(side1,side2)+2880.*C(main,main).^2.*C(main,side1).*C(main,side2).*C(side1,side1).*C(side1,side2)+1440.*C(main,main).^2.*C(main,side1).^2.*C(side1,side2).^2+1440.*C(main,main).^2.*C(main,side2).^2.*C(side1,side2).^2+240.*C(main,main).^3.*C(side1,side1).*C(side1,side2).^2+480.*C(main,main).*C(main,side1).^4.*C(side2,side2)+2880.*C(main,main).*C(main,side1).^2.*C(main,side2).^2.*C(side2,side2)+720.*C(main,main).^2.*C(main,side1).^2.*C(side1,side1).*C(side2,side2)+720.*C(main,main).^2.*C(main,side2).^2.*C(side1,side1).*C(side2,side2)+60.*C(main,main).^3.*C(side1,side1).^2.*C(side2,side2)+2880.*C(main,main).^2.*C(main,side1).*C(main,side2).*C(side1,side2).*C(side2,side2)+240.*C(main,main).^3.*C(side1,side2).^2.*C(side2,side2)+360.*C(main,main).^2.*C(main,side1).^2.*C(side2,side2).^2+60.*C(main,main).^3.*C(side1,side1).*C(side2,side2).^2).*M6(6)+(240.*C(main,side1).^4.*C(side1,side1).^2+240.*C(main,main).*C(main,side1).^2.*C(side1,side1).^3+15.*C(main,main).^2.*C(side1,side1).^4+240.*C(main,side2).^4.*C(side2,side2).^2+240.*C(main,main).*C(main,side2).^2.*C(side2,side2).^3+15.*C(main,main).^2.*C(side2,side2).^4).*M6(7)+(1440.*C(main,side1).^2.*C(main,side2).^2.*C(side1,side1).^2+240.*C(main,main).*C(main,side2).^2.*C(side1,side1).^3+3840.*C(main,side1).^3.*C(main,side2).*C(side1,side1).*C(side1,side2)+2880.*C(main,main).*C(main,side1).*C(main,side2).*C(side1,side1).^2.*C(side1,side2)+960.*C(main,side1).^4.*C(side1,side2).^2+960.*C(main,side2).^4.*C(side1,side2).^2+2880.*C(main,main).*C(main,side1).^2.*C(side1,side1).*C(side1,side2).^2+360.*C(main,main).^2.*C(side1,side1).^2.*C(side1,side2).^2+480.*C(main,side1).^4.*C(side1,side1).*C(side2,side2)+480.*C(main,side2).^4.*C(side1,side1).*C(side2,side2)+720.*C(main,main).*C(main,side1).^2.*C(side1,side1).^2.*C(side2,side2)+60.*C(main,main).^2.*C(side1,side1).^3.*C(side2,side2)+3840.*C(main,side1).*C(main,side2).^3.*C(side1,side2).*C(side2,side2)+2880.*C(main,main).*C(main,side2).^2.*C(side1,side2).^2.*C(side2,side2)+1440.*C(main,side1).^2.*C(main,side2).^2.*C(side2,side2).^2+720.*C(main,main).*C(main,side2).^2.*C(side1,side1).*C(side2,side2).^2+2880.*C(main,main).*C(main,side1).*C(main,side2).*C(side1,side2).*C(side2,side2).^2+360.*C(main,main).^2.*C(side1,side2).^2.*C(side2,side2).^2+240.*C(main,main).*C(main,side1).^2.*C(side2,side2).^3+60.*C(main,main).^2.*C(side1,side1).*C(side2,side2).^3).*M6(8)+(240.*C(main,side2).^4.*C(side1,side1).^2+3840.*C(main,side1).*C(main,side2).^3.*C(side1,side1).*C(side1,side2)+5760.*C(main,side1).^2.*C(main,side2).^2.*C(side1,side2).^2+2880.*C(main,main).*C(main,side2).^2.*C(side1,side1).*C(side1,side2).^2+3840.*C(main,main).*C(main,side1).*C(main,side2).*C(side1,side2).^3+240.*C(main,main).^2.*C(side1,side2).^4+2880.*C(main,side1).^2.*C(main,side2).^2.*C(side1,side1).*C(side2,side2)+720.*C(main,main).*C(main,side2).^2.*C(side1,side1).^2.*C(side2,side2)+3840.*C(main,side1).^3.*C(main,side2).*C(side1,side2).*C(side2,side2)+5760.*C(main,main).*C(main,side1).*C(main,side2).*C(side1,side1).*C(side1,side2).*C(side2,side2)+2880.*C(main,main).*C(main,side1).^2.*C(side1,side2).^2.*C(side2,side2)+720.*C(main,main).^2.*C(side1,side1).*C(side1,side2).^2.*C(side2,side2)+240.*C(main,side1).^4.*C(side2,side2).^2+720.*C(main,main).*C(main,side1).^2.*C(side1,side1).*C(side2,side2).^2+90.*C(main,main).^2.*C(side1,side1).^2.*C(side2,side2).^2).*M6(9)+(60.*C(main,side1).^2.*C(side1,side1).^4+6.*C(main,main).*C(side1,side1).^5+60.*C(main,side2).^2.*C(side2,side2).^4+6.*C(main,main).*C(side2,side2).^5).*M6(10)+(60.*C(main,side2).^2.*C(side1,side1).^4+960.*C(main,side1).*C(main,side2).*C(side1,side1).^3.*C(side1,side2)+1440.*C(main,side1).^2.*C(side1,side1).^2.*C(side1,side2).^2+240.*C(main,main).*C(side1,side1).^3.*C(side1,side2).^2+240.*C(main,side1).^2.*C(side1,side1).^3.*C(side2,side2)+30.*C(main,main).*C(side1,side1).^4.*C(side2,side2)+1440.*C(main,side2).^2.*C(side1,side2).^2.*C(side2,side2).^2+240.*C(main,side2).^2.*C(side1,side1).*C(side2,side2).^3+960.*C(main,side1).*C(main,side2).*C(side1,side2).*C(side2,side2).^3+240.*C(main,main).*C(side1,side2).^2.*C(side2,side2).^3+60.*C(main,side1).^2.*C(side2,side2).^4+30.*C(main,main).*C(side1,side1).*C(side2,side2).^4).*M6(11)+(1440.*C(main,side2).^2.*C(side1,side1).^2.*C(side1,side2).^2+3840.*C(main,side1).*C(main,side2).*C(side1,side1).*C(side1,side2).^3+960.*C(main,side1).^2.*C(side1,side2).^4+960.*C(main,side2).^2.*C(side1,side2).^4+480.*C(main,main).*C(side1,side1).*C(side1,side2).^4+240.*C(main,side2).^2.*C(side1,side1).^3.*C(side2,side2)+2880.*C(main,side1).*C(main,side2).*C(side1,side1).^2.*C(side1,side2).*C(side2,side2)+2880.*C(main,side1).^2.*C(side1,side1).*C(side1,side2).^2.*C(side2,side2)+2880.*C(main,side2).^2.*C(side1,side1).*C(side1,side2).^2.*C(side2,side2)+720.*C(main,main).*C(side1,side1).^2.*C(side1,side2).^2.*C(side2,side2)+3840.*C(main,side1).*C(main,side2).*C(side1,side2).^3.*C(side2,side2)+480.*C(main,main).*C(side1,side2).^4.*C(side2,side2)+360.*C(main,side1).^2.*C(side1,side1).^2.*C(side2,side2).^2+360.*C(main,side2).^2.*C(side1,side1).^2.*C(side2,side2).^2+60.*C(main,main).*C(side1,side1).^3.*C(side2,side2).^2+2880.*C(main,side1).*C(main,side2).*C(side1,side1).*C(side1,side2).*C(side2,side2).^2+1440.*C(main,side1).^2.*C(side1,side2).^2.*C(side2,side2).^2+720.*C(main,main).*C(side1,side1).*C(side1,side2).^2.*C(side2,side2).^2+240.*C(main,side1).^2.*C(side1,side1).*C(side2,side2).^3+60.*C(main,main).*C(side1,side1).^2.*C(side2,side2).^3).*M6(12)+(C(side1,side1).^6+C(side2,side2).^6).*M6(13)+(60.*C(side1,side1).^4.*C(side1,side2).^2+6.*C(side1,side1).^5.*C(side2,side2)+60.*C(side1,side2).^2.*C(side2,side2).^4+6.*C(side1,side1).*C(side2,side2).^5).*M6(14)+(240.*C(side1,side1).^2.*C(side1,side2).^4+240.*C(side1,side1).^3.*C(side1,side2).^2.*C(side2,side2)+15.*C(side1,side1).^4.*C(side2,side2).^2+240.*C(side1,side2).^4.*C(side2,side2).^2+240.*C(side1,side1).*C(side1,side2).^2.*C(side2,side2).^3+15.*C(side1,side1).^2.*C(side2,side2).^4).*M6(15)+(64.*C(side1,side2).^6+480.*C(side1,side1).*C(side1,side2).^4.*C(side2,side2)+360.*C(side1,side1).^2.*C(side1,side2).^2.*C(side2,side2).^2+20.*C(side1,side1).^3.*C(side2,side2).^3).*M6(16);
        
        M6D = zeros(3,3);
        M6D(main,side1)=60.*C(main,main).^4.*C(main,side1).*M6(2)+(1/2).*(960.*C(main,main).^2.*C(main,side1).^3+480.*C(main,main).^3.*C(main,side1).*C(side1,side1)).*M6(3)+(1/2).*(2880.*C(main,main).^2.*C(main,side1).*C(main,side2).^2+960.*C(main,main).^3.*C(main,side2).*C(side1,side2)+480.*C(main,main).^3.*C(main,side1).*C(side2,side2)).*M6(4)+(1/2).*(384.*C(main,side1).^5+1920.*C(main,main).*C(main,side1).^3.*C(side1,side1)+720.*C(main,main).^2.*C(main,side1).*C(side1,side1).^2).*M6(5)+(1/2).*(3840.*C(main,side1).^3.*C(main,side2).^2+1920.*C(main,side1).*C(main,side2).^4+5760.*C(main,main).*C(main,side1).*C(main,side2).^2.*C(side1,side1)+11520.*C(main,main).*C(main,side1).^2.*C(main,side2).*C(side1,side2)+3840.*C(main,main).*C(main,side2).^3.*C(side1,side2)+2880.*C(main,main).^2.*C(main,side2).*C(side1,side1).*C(side1,side2)+2880.*C(main,main).^2.*C(main,side1).*C(side1,side2).^2+1920.*C(main,main).*C(main,side1).^3.*C(side2,side2)+5760.*C(main,main).*C(main,side1).*C(main,side2).^2.*C(side2,side2)+1440.*C(main,main).^2.*C(main,side1).*C(side1,side1).*C(side2,side2)+2880.*C(main,main).^2.*C(main,side2).*C(side1,side2).*C(side2,side2)+720.*C(main,main).^2.*C(main,side1).*C(side2,side2).^2).*M6(6)+(1/2).*(960.*C(main,side1).^3.*C(side1,side1).^2+480.*C(main,main).*C(main,side1).*C(side1,side1).^3).*M6(7)+(1/2).*(2880.*C(main,side1).*C(main,side2).^2.*C(side1,side1).^2+11520.*C(main,side1).^2.*C(main,side2).*C(side1,side1).*C(side1,side2)+2880.*C(main,main).*C(main,side2).*C(side1,side1).^2.*C(side1,side2)+3840.*C(main,side1).^3.*C(side1,side2).^2+5760.*C(main,main).*C(main,side1).*C(side1,side1).*C(side1,side2).^2+1920.*C(main,side1).^3.*C(side1,side1).*C(side2,side2)+1440.*C(main,main).*C(main,side1).*C(side1,side1).^2.*C(side2,side2)+3840.*C(main,side2).^3.*C(side1,side2).*C(side2,side2)+2880.*C(main,side1).*C(main,side2).^2.*C(side2,side2).^2+2880.*C(main,main).*C(main,side2).*C(side1,side2).*C(side2,side2).^2+480.*C(main,main).*C(main,side1).*C(side2,side2).^3).*M6(8)+(1/2).*(3840.*C(main,side2).^3.*C(side1,side1).*C(side1,side2)+11520.*C(main,side1).*C(main,side2).^2.*C(side1,side2).^2+3840.*C(main,main).*C(main,side2).*C(side1,side2).^3+5760.*C(main,side1).*C(main,side2).^2.*C(side1,side1).*C(side2,side2)+11520.*C(main,side1).^2.*C(main,side2).*C(side1,side2).*C(side2,side2)+5760.*C(main,main).*C(main,side2).*C(side1,side1).*C(side1,side2).*C(side2,side2)+5760.*C(main,main).*C(main,side1).*C(side1,side2).^2.*C(side2,side2)+960.*C(main,side1).^3.*C(side2,side2).^2+1440.*C(main,main).*C(main,side1).*C(side1,side1).*C(side2,side2).^2).*M6(9)+60.*C(main,side1).*C(side1,side1).^4.*M6(10)+(1/2).*(960.*C(main,side2).*C(side1,side1).^3.*C(side1,side2)+2880.*C(main,side1).*C(side1,side1).^2.*C(side1,side2).^2+480.*C(main,side1).*C(side1,side1).^3.*C(side2,side2)+960.*C(main,side2).*C(side1,side2).*C(side2,side2).^3+120.*C(main,side1).*C(side2,side2).^4).*M6(11)+(1/2).*(3840.*C(main,side2).*C(side1,side1).*C(side1,side2).^3+1920.*C(main,side1).*C(side1,side2).^4+2880.*C(main,side2).*C(side1,side1).^2.*C(side1,side2).*C(side2,side2)+5760.*C(main,side1).*C(side1,side1).*C(side1,side2).^2.*C(side2,side2)+3840.*C(main,side2).*C(side1,side2).^3.*C(side2,side2)+720.*C(main,side1).*C(side1,side1).^2.*C(side2,side2).^2+2880.*C(main,side2).*C(side1,side1).*C(side1,side2).*C(side2,side2).^2+2880.*C(main,side1).*C(side1,side2).^2.*C(side2,side2).^2+480.*C(main,side1).*C(side1,side1).*C(side2,side2).^3).*M6(12);
        M6D(main,side2)=60.*C(main,main).^4.*C(main,side2).*M6(2)+(1/2).*(960.*C(main,main).^2.*C(main,side2).^3+480.*C(main,main).^3.*C(main,side2).*C(side2,side2)).*M6(3)+(1/2).*(2880.*C(main,main).^2.*C(main,side1).^2.*C(main,side2)+480.*C(main,main).^3.*C(main,side2).*C(side1,side1)+960.*C(main,main).^3.*C(main,side1).*C(side1,side2)).*M6(4)+(1/2).*(384.*C(main,side2).^5+1920.*C(main,main).*C(main,side2).^3.*C(side2,side2)+720.*C(main,main).^2.*C(main,side2).*C(side2,side2).^2).*M6(5)+(1/2).*(1920.*C(main,side1).^4.*C(main,side2)+3840.*C(main,side1).^2.*C(main,side2).^3+5760.*C(main,main).*C(main,side1).^2.*C(main,side2).*C(side1,side1)+1920.*C(main,main).*C(main,side2).^3.*C(side1,side1)+720.*C(main,main).^2.*C(main,side2).*C(side1,side1).^2+3840.*C(main,main).*C(main,side1).^3.*C(side1,side2)+11520.*C(main,main).*C(main,side1).*C(main,side2).^2.*C(side1,side2)+2880.*C(main,main).^2.*C(main,side1).*C(side1,side1).*C(side1,side2)+2880.*C(main,main).^2.*C(main,side2).*C(side1,side2).^2+5760.*C(main,main).*C(main,side1).^2.*C(main,side2).*C(side2,side2)+1440.*C(main,main).^2.*C(main,side2).*C(side1,side1).*C(side2,side2)+2880.*C(main,main).^2.*C(main,side1).*C(side1,side2).*C(side2,side2)).*M6(6)+(1/2).*(960.*C(main,side2).^3.*C(side2,side2).^2+480.*C(main,main).*C(main,side2).*C(side2,side2).^3).*M6(7)+(1/2).*(2880.*C(main,side1).^2.*C(main,side2).*C(side1,side1).^2+480.*C(main,main).*C(main,side2).*C(side1,side1).^3+3840.*C(main,side1).^3.*C(side1,side1).*C(side1,side2)+2880.*C(main,main).*C(main,side1).*C(side1,side1).^2.*C(side1,side2)+3840.*C(main,side2).^3.*C(side1,side2).^2+1920.*C(main,side2).^3.*C(side1,side1).*C(side2,side2)+11520.*C(main,side1).*C(main,side2).^2.*C(side1,side2).*C(side2,side2)+5760.*C(main,main).*C(main,side2).*C(side1,side2).^2.*C(side2,side2)+2880.*C(main,side1).^2.*C(main,side2).*C(side2,side2).^2+1440.*C(main,main).*C(main,side2).*C(side1,side1).*C(side2,side2).^2+2880.*C(main,main).*C(main,side1).*C(side1,side2).*C(side2,side2).^2).*M6(8)+(1/2).*(960.*C(main,side2).^3.*C(side1,side1).^2+11520.*C(main,side1).*C(main,side2).^2.*C(side1,side1).*C(side1,side2)+11520.*C(main,side1).^2.*C(main,side2).*C(side1,side2).^2+5760.*C(main,main).*C(main,side2).*C(side1,side1).*C(side1,side2).^2+3840.*C(main,main).*C(main,side1).*C(side1,side2).^3+5760.*C(main,side1).^2.*C(main,side2).*C(side1,side1).*C(side2,side2)+1440.*C(main,main).*C(main,side2).*C(side1,side1).^2.*C(side2,side2)+3840.*C(main,side1).^3.*C(side1,side2).*C(side2,side2)+5760.*C(main,main).*C(main,side1).*C(side1,side1).*C(side1,side2).*C(side2,side2)).*M6(9)+60.*C(main,side2).*C(side2,side2).^4.*M6(10)+(1/2).*(120.*C(main,side2).*C(side1,side1).^4+960.*C(main,side1).*C(side1,side1).^3.*C(side1,side2)+2880.*C(main,side2).*C(side1,side2).^2.*C(side2,side2).^2+480.*C(main,side2).*C(side1,side1).*C(side2,side2).^3+960.*C(main,side1).*C(side1,side2).*C(side2,side2).^3).*M6(11)+(1/2).*(2880.*C(main,side2).*C(side1,side1).^2.*C(side1,side2).^2+3840.*C(main,side1).*C(side1,side1).*C(side1,side2).^3+1920.*C(main,side2).*C(side1,side2).^4+480.*C(main,side2).*C(side1,side1).^3.*C(side2,side2)+2880.*C(main,side1).*C(side1,side1).^2.*C(side1,side2).*C(side2,side2)+5760.*C(main,side2).*C(side1,side1).*C(side1,side2).^2.*C(side2,side2)+3840.*C(main,side1).*C(side1,side2).^3.*C(side2,side2)+720.*C(main,side2).*C(side1,side1).^2.*C(side2,side2).^2+2880.*C(main,side1).*C(side1,side1).*C(side1,side2).*C(side2,side2).^2).*M6(12);
        M6D(side1,side2)=(1/2).*(960.*C(main,main).^3.*C(main,side1).*C(main,side2)+120.*C(main,main).^4.*C(side1,side2)).*M6(4)+(1/2).*(3840.*C(main,main).*C(main,side1).^3.*C(main,side2)+3840.*C(main,main).*C(main,side1).*C(main,side2).^3+2880.*C(main,main).^2.*C(main,side1).*C(main,side2).*C(side1,side1)+2880.*C(main,main).^2.*C(main,side1).^2.*C(side1,side2)+2880.*C(main,main).^2.*C(main,side2).^2.*C(side1,side2)+480.*C(main,main).^3.*C(side1,side1).*C(side1,side2)+2880.*C(main,main).^2.*C(main,side1).*C(main,side2).*C(side2,side2)+480.*C(main,main).^3.*C(side1,side2).*C(side2,side2)).*M6(6)+(1/2).*(3840.*C(main,side1).^3.*C(main,side2).*C(side1,side1)+2880.*C(main,main).*C(main,side1).*C(main,side2).*C(side1,side1).^2+1920.*C(main,side1).^4.*C(side1,side2)+1920.*C(main,side2).^4.*C(side1,side2)+5760.*C(main,main).*C(main,side1).^2.*C(side1,side1).*C(side1,side2)+720.*C(main,main).^2.*C(side1,side1).^2.*C(side1,side2)+3840.*C(main,side1).*C(main,side2).^3.*C(side2,side2)+5760.*C(main,main).*C(main,side2).^2.*C(side1,side2).*C(side2,side2)+2880.*C(main,main).*C(main,side1).*C(main,side2).*C(side2,side2).^2+720.*C(main,main).^2.*C(side1,side2).*C(side2,side2).^2).*M6(8)+(1/2).*(3840.*C(main,side1).*C(main,side2).^3.*C(side1,side1)+11520.*C(main,side1).^2.*C(main,side2).^2.*C(side1,side2)+5760.*C(main,main).*C(main,side2).^2.*C(side1,side1).*C(side1,side2)+11520.*C(main,main).*C(main,side1).*C(main,side2).*C(side1,side2).^2+960.*C(main,main).^2.*C(side1,side2).^3+3840.*C(main,side1).^3.*C(main,side2).*C(side2,side2)+5760.*C(main,main).*C(main,side1).*C(main,side2).*C(side1,side1).*C(side2,side2)+5760.*C(main,main).*C(main,side1).^2.*C(side1,side2).*C(side2,side2)+1440.*C(main,main).^2.*C(side1,side1).*C(side1,side2).*C(side2,side2)).*M6(9)+(1/2).*(960.*C(main,side1).*C(main,side2).*C(side1,side1).^3+2880.*C(main,side1).^2.*C(side1,side1).^2.*C(side1,side2)+480.*C(main,main).*C(side1,side1).^3.*C(side1,side2)+2880.*C(main,side2).^2.*C(side1,side2).*C(side2,side2).^2+960.*C(main,side1).*C(main,side2).*C(side2,side2).^3+480.*C(main,main).*C(side1,side2).*C(side2,side2).^3).*M6(11)+(1/2).*(2880.*C(main,side2).^2.*C(side1,side1).^2.*C(side1,side2)+11520.*C(main,side1).*C(main,side2).*C(side1,side1).*C(side1,side2).^2+3840.*C(main,side1).^2.*C(side1,side2).^3+3840.*C(main,side2).^2.*C(side1,side2).^3+1920.*C(main,main).*C(side1,side1).*C(side1,side2).^3+2880.*C(main,side1).*C(main,side2).*C(side1,side1).^2.*C(side2,side2)+5760.*C(main,side1).^2.*C(side1,side1).*C(side1,side2).*C(side2,side2)+5760.*C(main,side2).^2.*C(side1,side1).*C(side1,side2).*C(side2,side2)+1440.*C(main,main).*C(side1,side1).^2.*C(side1,side2).*C(side2,side2)+11520.*C(main,side1).*C(main,side2).*C(side1,side2).^2.*C(side2,side2)+1920.*C(main,main).*C(side1,side2).^3.*C(side2,side2)+2880.*C(main,side1).*C(main,side2).*C(side1,side1).*C(side2,side2).^2+2880.*C(main,side1).^2.*C(side1,side2).*C(side2,side2).^2+1440.*C(main,main).*C(side1,side1).*C(side1,side2).*C(side2,side2).^2).*M6(12)+(1/2).*(120.*C(side1,side1).^4.*C(side1,side2)+120.*C(side1,side2).*C(side2,side2).^4).*M6(14)+(1/2).*(960.*C(side1,side1).^2.*C(side1,side2).^3+480.*C(side1,side1).^3.*C(side1,side2).*C(side2,side2)+960.*C(side1,side2).^3.*C(side2,side2).^2+480.*C(side1,side1).*C(side1,side2).*C(side2,side2).^3).*M6(15)+(1/2).*(384.*C(side1,side2).^5+1920.*C(side1,side1).*C(side1,side2).^3.*C(side2,side2)+720.*C(side1,side1).^2.*C(side1,side2).*C(side2,side2).^2).*M6(16);
        M6D = M6D+M6D';
        M6D(main,main)=6.*C(main,main).^5.*M6(1)+(240.*C(main,main).^3.*C(main,side1).^2+240.*C(main,main).^3.*C(main,side2).^2+30.*C(main,main).^4.*C(side1,side1)+30.*C(main,main).^4.*C(side2,side2)).*M6(2)+(480.*C(main,main).*C(main,side1).^4+480.*C(main,main).*C(main,side2).^4+720.*C(main,main).^2.*C(main,side1).^2.*C(side1,side1)+60.*C(main,main).^3.*C(side1,side1).^2+720.*C(main,main).^2.*C(main,side2).^2.*C(side2,side2)+60.*C(main,main).^3.*C(side2,side2).^2).*M6(3)+(2880.*C(main,main).*C(main,side1).^2.*C(main,side2).^2+720.*C(main,main).^2.*C(main,side2).^2.*C(side1,side1)+2880.*C(main,main).^2.*C(main,side1).*C(main,side2).*C(side1,side2)+240.*C(main,main).^3.*C(side1,side2).^2+720.*C(main,main).^2.*C(main,side1).^2.*C(side2,side2)+120.*C(main,main).^3.*C(side1,side1).*C(side2,side2)).*M6(4)+(480.*C(main,side1).^4.*C(side1,side1)+720.*C(main,main).*C(main,side1).^2.*C(side1,side1).^2+60.*C(main,main).^2.*C(side1,side1).^3+480.*C(main,side2).^4.*C(side2,side2)+720.*C(main,main).*C(main,side2).^2.*C(side2,side2).^2+60.*C(main,main).^2.*C(side2,side2).^3).*M6(5)+(2880.*C(main,side1).^2.*C(main,side2).^2.*C(side1,side1)+480.*C(main,side2).^4.*C(side1,side1)+720.*C(main,main).*C(main,side2).^2.*C(side1,side1).^2+3840.*C(main,side1).^3.*C(main,side2).*C(side1,side2)+3840.*C(main,side1).*C(main,side2).^3.*C(side1,side2)+5760.*C(main,main).*C(main,side1).*C(main,side2).*C(side1,side1).*C(side1,side2)+2880.*C(main,main).*C(main,side1).^2.*C(side1,side2).^2+2880.*C(main,main).*C(main,side2).^2.*C(side1,side2).^2+720.*C(main,main).^2.*C(side1,side1).*C(side1,side2).^2+480.*C(main,side1).^4.*C(side2,side2)+2880.*C(main,side1).^2.*C(main,side2).^2.*C(side2,side2)+1440.*C(main,main).*C(main,side1).^2.*C(side1,side1).*C(side2,side2)+1440.*C(main,main).*C(main,side2).^2.*C(side1,side1).*C(side2,side2)+180.*C(main,main).^2.*C(side1,side1).^2.*C(side2,side2)+5760.*C(main,main).*C(main,side1).*C(main,side2).*C(side1,side2).*C(side2,side2)+720.*C(main,main).^2.*C(side1,side2).^2.*C(side2,side2)+720.*C(main,main).*C(main,side1).^2.*C(side2,side2).^2+180.*C(main,main).^2.*C(side1,side1).*C(side2,side2).^2).*M6(6)+(240.*C(main,side1).^2.*C(side1,side1).^3+30.*C(main,main).*C(side1,side1).^4+240.*C(main,side2).^2.*C(side2,side2).^3+30.*C(main,main).*C(side2,side2).^4).*M6(7)+(240.*C(main,side2).^2.*C(side1,side1).^3+2880.*C(main,side1).*C(main,side2).*C(side1,side1).^2.*C(side1,side2)+2880.*C(main,side1).^2.*C(side1,side1).*C(side1,side2).^2+720.*C(main,main).*C(side1,side1).^2.*C(side1,side2).^2+720.*C(main,side1).^2.*C(side1,side1).^2.*C(side2,side2)+120.*C(main,main).*C(side1,side1).^3.*C(side2,side2)+2880.*C(main,side2).^2.*C(side1,side2).^2.*C(side2,side2)+720.*C(main,side2).^2.*C(side1,side1).*C(side2,side2).^2+2880.*C(main,side1).*C(main,side2).*C(side1,side2).*C(side2,side2).^2+720.*C(main,main).*C(side1,side2).^2.*C(side2,side2).^2+240.*C(main,side1).^2.*C(side2,side2).^3+120.*C(main,main).*C(side1,side1).*C(side2,side2).^3).*M6(8)+(2880.*C(main,side2).^2.*C(side1,side1).*C(side1,side2).^2+3840.*C(main,side1).*C(main,side2).*C(side1,side2).^3+480.*C(main,main).*C(side1,side2).^4+720.*C(main,side2).^2.*C(side1,side1).^2.*C(side2,side2)+5760.*C(main,side1).*C(main,side2).*C(side1,side1).*C(side1,side2).*C(side2,side2)+2880.*C(main,side1).^2.*C(side1,side2).^2.*C(side2,side2)+1440.*C(main,main).*C(side1,side1).*C(side1,side2).^2.*C(side2,side2)+720.*C(main,side1).^2.*C(side1,side1).*C(side2,side2).^2+180.*C(main,main).*C(side1,side1).^2.*C(side2,side2).^2).*M6(9)+(6.*C(side1,side1).^5+6.*C(side2,side2).^5).*M6(10)+(240.*C(side1,side1).^3.*C(side1,side2).^2+30.*C(side1,side1).^4.*C(side2,side2)+240.*C(side1,side2).^2.*C(side2,side2).^3+30.*C(side1,side1).*C(side2,side2).^4).*M6(11)+(480.*C(side1,side1).*C(side1,side2).^4+720.*C(side1,side1).^2.*C(side1,side2).^2.*C(side2,side2)+480.*C(side1,side2).^4.*C(side2,side2)+60.*C(side1,side1).^3.*C(side2,side2).^2+720.*C(side1,side1).*C(side1,side2).^2.*C(side2,side2).^2+60.*C(side1,side1).^2.*C(side2,side2).^3).*M6(12);
        M6D(side1,side1)=6.*C(main,main).^5.*M6(2)+(240.*C(main,main).^3.*C(main,side1).^2+30.*C(main,main).^4.*C(side1,side1)).*M6(3)+(240.*C(main,main).^3.*C(main,side2).^2+30.*C(main,main).^4.*C(side2,side2)).*M6(4)+(480.*C(main,main).*C(main,side1).^4+720.*C(main,main).^2.*C(main,side1).^2.*C(side1,side1)+60.*C(main,main).^3.*C(side1,side1).^2).*M6(5)+(2880.*C(main,main).*C(main,side1).^2.*C(main,side2).^2+480.*C(main,main).*C(main,side2).^4+720.*C(main,main).^2.*C(main,side2).^2.*C(side1,side1)+2880.*C(main,main).^2.*C(main,side1).*C(main,side2).*C(side1,side2)+240.*C(main,main).^3.*C(side1,side2).^2+720.*C(main,main).^2.*C(main,side1).^2.*C(side2,side2)+720.*C(main,main).^2.*C(main,side2).^2.*C(side2,side2)+120.*C(main,main).^3.*C(side1,side1).*C(side2,side2)+60.*C(main,main).^3.*C(side2,side2).^2).*M6(6)+(480.*C(main,side1).^4.*C(side1,side1)+720.*C(main,main).*C(main,side1).^2.*C(side1,side1).^2+60.*C(main,main).^2.*C(side1,side1).^3).*M6(7)+(2880.*C(main,side1).^2.*C(main,side2).^2.*C(side1,side1)+720.*C(main,main).*C(main,side2).^2.*C(side1,side1).^2+3840.*C(main,side1).^3.*C(main,side2).*C(side1,side2)+5760.*C(main,main).*C(main,side1).*C(main,side2).*C(side1,side1).*C(side1,side2)+2880.*C(main,main).*C(main,side1).^2.*C(side1,side2).^2+720.*C(main,main).^2.*C(side1,side1).*C(side1,side2).^2+480.*C(main,side1).^4.*C(side2,side2)+480.*C(main,side2).^4.*C(side2,side2)+1440.*C(main,main).*C(main,side1).^2.*C(side1,side1).*C(side2,side2)+180.*C(main,main).^2.*C(side1,side1).^2.*C(side2,side2)+720.*C(main,main).*C(main,side2).^2.*C(side2,side2).^2+60.*C(main,main).^2.*C(side2,side2).^3).*M6(8)+(480.*C(main,side2).^4.*C(side1,side1)+3840.*C(main,side1).*C(main,side2).^3.*C(side1,side2)+2880.*C(main,main).*C(main,side2).^2.*C(side1,side2).^2+2880.*C(main,side1).^2.*C(main,side2).^2.*C(side2,side2)+1440.*C(main,main).*C(main,side2).^2.*C(side1,side1).*C(side2,side2)+5760.*C(main,main).*C(main,side1).*C(main,side2).*C(side1,side2).*C(side2,side2)+720.*C(main,main).^2.*C(side1,side2).^2.*C(side2,side2)+720.*C(main,main).*C(main,side1).^2.*C(side2,side2).^2+180.*C(main,main).^2.*C(side1,side1).*C(side2,side2).^2).*M6(9)+(240.*C(main,side1).^2.*C(side1,side1).^3+30.*C(main,main).*C(side1,side1).^4).*M6(10)+(240.*C(main,side2).^2.*C(side1,side1).^3+2880.*C(main,side1).*C(main,side2).*C(side1,side1).^2.*C(side1,side2)+2880.*C(main,side1).^2.*C(side1,side1).*C(side1,side2).^2+720.*C(main,main).*C(side1,side1).^2.*C(side1,side2).^2+720.*C(main,side1).^2.*C(side1,side1).^2.*C(side2,side2)+120.*C(main,main).*C(side1,side1).^3.*C(side2,side2)+240.*C(main,side2).^2.*C(side2,side2).^3+30.*C(main,main).*C(side2,side2).^4).*M6(11)+(2880.*C(main,side2).^2.*C(side1,side1).*C(side1,side2).^2+3840.*C(main,side1).*C(main,side2).*C(side1,side2).^3+480.*C(main,main).*C(side1,side2).^4+720.*C(main,side2).^2.*C(side1,side1).^2.*C(side2,side2)+5760.*C(main,side1).*C(main,side2).*C(side1,side1).*C(side1,side2).*C(side2,side2)+2880.*C(main,side1).^2.*C(side1,side2).^2.*C(side2,side2)+2880.*C(main,side2).^2.*C(side1,side2).^2.*C(side2,side2)+1440.*C(main,main).*C(side1,side1).*C(side1,side2).^2.*C(side2,side2)+720.*C(main,side1).^2.*C(side1,side1).*C(side2,side2).^2+720.*C(main,side2).^2.*C(side1,side1).*C(side2,side2).^2+180.*C(main,main).*C(side1,side1).^2.*C(side2,side2).^2+2880.*C(main,side1).*C(main,side2).*C(side1,side2).*C(side2,side2).^2+720.*C(main,main).*C(side1,side2).^2.*C(side2,side2).^2+240.*C(main,side1).^2.*C(side2,side2).^3+120.*C(main,main).*C(side1,side1).*C(side2,side2).^3).*M6(12)+6.*C(side1,side1).^5.*M6(13)+(240.*C(side1,side1).^3.*C(side1,side2).^2+30.*C(side1,side1).^4.*C(side2,side2)+6.*C(side2,side2).^5).*M6(14)+(480.*C(side1,side1).*C(side1,side2).^4+720.*C(side1,side1).^2.*C(side1,side2).^2.*C(side2,side2)+60.*C(side1,side1).^3.*C(side2,side2).^2+240.*C(side1,side2).^2.*C(side2,side2).^3+30.*C(side1,side1).*C(side2,side2).^4).*M6(15)+(480.*C(side1,side2).^4.*C(side2,side2)+720.*C(side1,side1).*C(side1,side2).^2.*C(side2,side2).^2+60.*C(side1,side1).^2.*C(side2,side2).^3).*M6(16);
        M6D(side2,side2)=6.*C(main,main).^5.*M6(2)+(240.*C(main,main).^3.*C(main,side2).^2+30.*C(main,main).^4.*C(side2,side2)).*M6(3)+(240.*C(main,main).^3.*C(main,side1).^2+30.*C(main,main).^4.*C(side1,side1)).*M6(4)+(480.*C(main,main).*C(main,side2).^4+720.*C(main,main).^2.*C(main,side2).^2.*C(side2,side2)+60.*C(main,main).^3.*C(side2,side2).^2).*M6(5)+(480.*C(main,main).*C(main,side1).^4+2880.*C(main,main).*C(main,side1).^2.*C(main,side2).^2+720.*C(main,main).^2.*C(main,side1).^2.*C(side1,side1)+720.*C(main,main).^2.*C(main,side2).^2.*C(side1,side1)+60.*C(main,main).^3.*C(side1,side1).^2+2880.*C(main,main).^2.*C(main,side1).*C(main,side2).*C(side1,side2)+240.*C(main,main).^3.*C(side1,side2).^2+720.*C(main,main).^2.*C(main,side1).^2.*C(side2,side2)+120.*C(main,main).^3.*C(side1,side1).*C(side2,side2)).*M6(6)+(480.*C(main,side2).^4.*C(side2,side2)+720.*C(main,main).*C(main,side2).^2.*C(side2,side2).^2+60.*C(main,main).^2.*C(side2,side2).^3).*M6(7)+(480.*C(main,side1).^4.*C(side1,side1)+480.*C(main,side2).^4.*C(side1,side1)+720.*C(main,main).*C(main,side1).^2.*C(side1,side1).^2+60.*C(main,main).^2.*C(side1,side1).^3+3840.*C(main,side1).*C(main,side2).^3.*C(side1,side2)+2880.*C(main,main).*C(main,side2).^2.*C(side1,side2).^2+2880.*C(main,side1).^2.*C(main,side2).^2.*C(side2,side2)+1440.*C(main,main).*C(main,side2).^2.*C(side1,side1).*C(side2,side2)+5760.*C(main,main).*C(main,side1).*C(main,side2).*C(side1,side2).*C(side2,side2)+720.*C(main,main).^2.*C(side1,side2).^2.*C(side2,side2)+720.*C(main,main).*C(main,side1).^2.*C(side2,side2).^2+180.*C(main,main).^2.*C(side1,side1).*C(side2,side2).^2).*M6(8)+(2880.*C(main,side1).^2.*C(main,side2).^2.*C(side1,side1)+720.*C(main,main).*C(main,side2).^2.*C(side1,side1).^2+3840.*C(main,side1).^3.*C(main,side2).*C(side1,side2)+5760.*C(main,main).*C(main,side1).*C(main,side2).*C(side1,side1).*C(side1,side2)+2880.*C(main,main).*C(main,side1).^2.*C(side1,side2).^2+720.*C(main,main).^2.*C(side1,side1).*C(side1,side2).^2+480.*C(main,side1).^4.*C(side2,side2)+1440.*C(main,main).*C(main,side1).^2.*C(side1,side1).*C(side2,side2)+180.*C(main,main).^2.*C(side1,side1).^2.*C(side2,side2)).*M6(9)+(240.*C(main,side2).^2.*C(side2,side2).^3+30.*C(main,main).*C(side2,side2).^4).*M6(10)+(240.*C(main,side1).^2.*C(side1,side1).^3+30.*C(main,main).*C(side1,side1).^4+2880.*C(main,side2).^2.*C(side1,side2).^2.*C(side2,side2)+720.*C(main,side2).^2.*C(side1,side1).*C(side2,side2).^2+2880.*C(main,side1).*C(main,side2).*C(side1,side2).*C(side2,side2).^2+720.*C(main,main).*C(side1,side2).^2.*C(side2,side2).^2+240.*C(main,side1).^2.*C(side2,side2).^3+120.*C(main,main).*C(side1,side1).*C(side2,side2).^3).*M6(11)+(240.*C(main,side2).^2.*C(side1,side1).^3+2880.*C(main,side1).*C(main,side2).*C(side1,side1).^2.*C(side1,side2)+2880.*C(main,side1).^2.*C(side1,side1).*C(side1,side2).^2+2880.*C(main,side2).^2.*C(side1,side1).*C(side1,side2).^2+720.*C(main,main).*C(side1,side1).^2.*C(side1,side2).^2+3840.*C(main,side1).*C(main,side2).*C(side1,side2).^3+480.*C(main,main).*C(side1,side2).^4+720.*C(main,side1).^2.*C(side1,side1).^2.*C(side2,side2)+720.*C(main,side2).^2.*C(side1,side1).^2.*C(side2,side2)+120.*C(main,main).*C(side1,side1).^3.*C(side2,side2)+5760.*C(main,side1).*C(main,side2).*C(side1,side1).*C(side1,side2).*C(side2,side2)+2880.*C(main,side1).^2.*C(side1,side2).^2.*C(side2,side2)+1440.*C(main,main).*C(side1,side1).*C(side1,side2).^2.*C(side2,side2)+720.*C(main,side1).^2.*C(side1,side1).*C(side2,side2).^2+180.*C(main,main).*C(side1,side1).^2.*C(side2,side2).^2).*M6(12)+6.*C(side2,side2).^5.*M6(13)+(6.*C(side1,side1).^5+240.*C(side1,side2).^2.*C(side2,side2).^3+30.*C(side1,side1).*C(side2,side2).^4).*M6(14)+(240.*C(side1,side1).^3.*C(side1,side2).^2+30.*C(side1,side1).^4.*C(side2,side2)+480.*C(side1,side2).^4.*C(side2,side2)+720.*C(side1,side1).*C(side1,side2).^2.*C(side2,side2).^2+60.*C(side1,side1).^2.*C(side2,side2).^3).*M6(15)+(480.*C(side1,side1).*C(side1,side2).^4+720.*C(side1,side1).^2.*C(side1,side2).^2.*C(side2,side2)+60.*C(side1,side1).^3.*C(side2,side2).^2).*M6(16);
        M6D = M6D/6;
        
        Accumulant = Accumulant + 8/3*b^2*( 4*b*M2D*(C6M6-3*C4M4*C2M2+2*C2M2^3) +3*(M2D*(2*C2M2^2-C4M4)-2*C2M2*M4D+M6D));
    end
end
StressTensor = Prefactor * FF*Accumulant*FF';
